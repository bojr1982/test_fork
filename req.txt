/*INSERT into pmplocal*/
SELECT '2022',a.`STOCK-CODE` AS stk,a.`CURR-QTY-I` AS qte, a.`CURR-NET-PR-I` as pmpdevise, b.`MSF220-CURRENCY-TYPE` AS devise, (99999999 - a.`REVSD-CRT-DATE`) AS datecreation, c.`MSF912-FOREIGN-CURR`,c.`MSF912-BUYING-RATE`,c.`MSF912-LAST-MOD-DATE`,(a.`CURR-NET-PR-I`/c.`MSF912-BUYING-RATE`) AS pmploc
FROM mims.msf221 a
INNER JOIN mims.msf220 b ON a.`PO-NO` = b.`MSF220-PO-NO` 
INNER join mims.msf912 c on (99999999 - a.`REVSD-CRT-DATE`)  >= (99999999 - c.`MSF912-DATE-PER-REVSD`)   and b.`MSF220-CURRENCY-TYPE` = c.`MSF912-FOREIGN-CURR` and c.`MSF912-LOCAL-CURRENCY` = 'mlt '
/*WHERE (99999999 - a.`REVSD-CRT-DATE`) BETWEEN '20220101' AND '20221231'*/
GROUP BY a.`STOCK-CODE`